<div class=" bg-white" style="min-height:93vh;position:relative;overflow:hidden">
  <breadcrumb></breadcrumb>

  <div class="row">
      <div class="container-fluid">
        <uib-tabset>
          <uib-tab active="browseTab">
            <uib-tab-heading>
              Browse
              <i class="fa fa-list-ul"></i>
            </uib-tab-heading>
              <div class="row">
                <div class="col-sm-9" style="margin-top:15px">
                  <div style="position: absolute;top:400px;left:35%;" ng-if="loadingData">
                    <img src="https://media1.tenor.com/images/db85ba00c6073b451a8f05156a66524e/tenor.gif?itemid=9856796" alt="">
                  </div>
                  <div ng-if="!isTableView" class="col-md-4" style="margin-bottom:20px; padding-left:10px;padding-right:10px;" ng-repeat="data in reviewData" ng-click="tableAction($index)">
                    <div class="container-fluid card" style="padding-bottom:0px">
                      <div class="row" style="border-bottom: 1px solid #dedede; height:170px; opacity:0.9;letter-spacing:0.6px; {{data[0].user_id==null ? 'background-color: #fc000033':''}}; {{data[0].statusChat=='closed'?'background-color: #16e61133':'' }}">
                        <div class="col-md-12">
                          <h5 style="font-weight:501">Agent Name : {{data[0].user_id | getName}}
                             <span ng-if="data[0].rating == 5" class="pull-right">
                               <i class="fa fa fa-smile-o fa-lg" style="color:#086b0a" aria-hidden="true"></i>
                               <i class="fa fa-star fa-lg" style="color:#086b0a" aria-hidden="true"></i>
                              </span>
                             <span ng-if="data[0].rating == 4" class="pull-right">
                                <i class="fa fa fa-smile-o fa-lg" style="color:#2fdd23" aria-hidden="true"></i>
                               <i class="fa fa-star fa-lg" style="color:#2fdd23" aria-hidden="true"></i>
                              </span>
                             <span ng-if="data[0].rating == 3" class="pull-right">
                                <i class="fa fa-meh-o fa-lg" style="color:#dff20c" aria-hidden="true"></i>
                                <i class="fa fa-star fa-lg" style="color:#dff20c" aria-hidden="true"></i>
                               </span>
                             <span ng-if="data[0].rating == 2||data[0].rating == 1" class="pull-right">
                                <i class="fa fa fa-frown-o fa-lg" style="color:#f70202" aria-hidden="true"></i>
                                <i class="fa fa-star fa-lg" style="color:#f70202" aria-hidden="true"></i>
                            </span>
                          </h5>

                          <h5 style="font-weight:501">UID : {{data[0].uid}}
                            <span class="pull-right" style="color:#286090 ;font-size:15px">{{data[0].numOfComments}} <i class="fa fa-comments-o fa-lg" aria-hidden="true"></i></span>
                          </h5>
                          <h5 style="font-weight:501">Client : {{data[0].company}}</h5>
                          <h5 style="font-weight:501" ng-if="data[0].email">Visitor's Email :  {{data[0].email}}</h5>
                          <h5 style="font-weight:501" ng-if="data[0].chatDuration!=0">Chat Duration :  {{data[0].chatDuration}} Min</h5>
                          <h5 style="font-weight:501" ng-if="data[0].statusChat">Status :  {{data[0].statusChat}}
                             <span ng-if="data[0].statusChat!='started'">by
                               <span ng-if="data[0][data[0].statusChat+'By']&&data[0][data[0].statusChat+'On']">{{data[0][data[0].statusChat+'By']}}</span>
                               <span ng-if="data[0][data[0].statusChat+'On']&&!data[0][data[0].statusChat+'By']">Visitor</span>
                              on {{data[0][data[0].statusChat+'On'].split('.')[0].split(' ')[0]}} at {{data[0][data[0].statusChat+'On'].split('.')[0].split(' ')[1]}} </span>
                           </h5>
                        </div>
                      </div>
                      <div class="row container-fluid" style="padding-top:10px;height:50px;background-color:#286090; opacity:1">
                        <div class="col-md-12" style="color:#fff">
                          <h5>Date: {{data[0].created | date : 'dd-MMM-yyyy'}}
                            <span class="pull-right" style="cursor:pointer;"><i class="fa fa-info-circle fa-lg"></i></span>
                          </h5>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12" ng-if="isTableView">
                    <table style="width:100%;font-size:16px" id="myQATable" datatable="" class="row-border hover">
                      <thead>
                        <tr id="myQATableHeader">
                          <th style="text-align:center;display:none">Chat Start</th>
                        </tr>
                      </thead>
                     <tbody>
                       <tr ng-repeat="data in reviewData" style="" ng-click="tableAction(data,true)">
                         <td>
                           <div class="" style="border-radius:50%;width:50px;height:50px;margin:5px 10px;float:left">
                             <!-- <img style="width:50px" src="{{data[0].user_id| getDP}}" alt=""> -->
                             <img style="width:50px" src="http://icons.iconarchive.com/icons/hopstarter/sleek-xp-basic/256/Administrator-icon.png" alt="">
                           </div>
                           <span style="display:inline-block">
                             <div class="">
                               <span style="font-size: 15px;font-weight: 700;">{{data[0].user_id | getName}}</span>
                               <span style="font-size: 13px;font-weight: 400;">{{data[0].company? data[0].company:'-'}}</span>
                             </div>
                             <div class="">
                               <span style="font-size: 14px;">{{data[0].uid}}</span>
                             </div>
                             <div class="">
                               <span style="font-size: 13px;opacity: 0.8;">Created : {{data[0].created|  date : 'dd-MMM-yyyy'}}</span>
                             </div>
                           </span>
                           <div class="" style="margin:5px 10px;float:right;font-size:20px;padding:12px;opacity:0.6;">
                            <i ng-if="data[0].typ=='audio'" class="fa fa-phone fa-lg" aria-hidden="true"></i>
                            <i ng-if="data[0].typ=='video'" class="fa fa-video-camera fa-lg" aria-hidden="true"></i>
                          </div>
                         </td>
                       </tr>
                     </tbody>
                    </table>
                  </div>
                  <div class="" style="position: absolute;top:400px;left:40%;color:#f0f0f0;font-size:40px" ng-if="myDialouge">
                    No More Data
                  </div>
                </div>
                <div class="col-sm-3">

                  <div class="container-fluid" style="position:fixed;background-color:#f0f0f0;width:21%;padding:20px 30px;box-shadow:-1px -1px 1px #f6f6f6;height:100vh">
                      <div style="display:block;margin:10px 0px;">
                        <button type="button" class="btn btn-block btn-primary" ng-click="setMyView()" style="outline:none">
                           <i ng-if="!isTableView"class="fa fa-table fa-md"  aria-hidden="true">
                             <span>Switch to Table View</span>
                           </i>
                           <i ng-if="isTableView" class="fa fa-address-card-o fa-md" aria-hidden="true">
                             <span>Switch to Column View</span>
                           </i>
                        </button>
                      </div>
                      <div class="form-group">
                        <label> Select Date </label>
                        <div class="input-group">
                          <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="form.date" is-open="status.opened" />
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="status.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
                          </span>
                        </div>
                      </div>
                      <div class="form-group">
                        <label> Agent Name </label>
                        <input type="text" class="form-control" placeholder="Search and select" uib-typeahead="user as user.username for user in userSearch($viewValue)" ng-model="form.user">
                      </div>
                      <div class="form-group">
                        <label> Client Name </label>
                        <input type="text" class="form-control" placeholder="Search and select" uib-typeahead="service as service.name for service in serviceSearch($viewValue)" ng-model="form.client">
                      </div>
                      <div class="form-group">
                        <label> Visitor Email </label>
                        <input type="email" class="form-control" placeholder="User E-mail..." ng-model="form.email">
                      </div>
                      <div class="form-group">
                        <label>Select Chat Type (Audio/Video):</label>
                        <select class="form-control" ng-model="form.selectedChatType" style="outline:none">
                          <option ng-repeat="chatType in chatTypes" value="{{chatType}}">{{chatType}}</option>
                        </select>
                      </div>
                      <div class="btn-group" style="padding-top:20px;">
                        <button type="button" class="btn btn-primary" ng-click="filterData()">
                          <strong>Filter</strong>
                        </button>
                        <button type="button" class="btn btn-default" ng-click="download()" ng-if="reviewData.length>0">
                          Download <i class="fa fa-download"></i>
                        </button>

                      </div>
                      <div class="form-group" style="margin-top:20px">
                        <label>Sort By:</label>
                        <select class="form-control" ng-model="selectedSortOption.value" style="border:0">
                          <option ng-repeat="sort in sortOptions" value="{{sort}}" style="border:0">{{sort}} </option>
                        </select>
                      </div>
                  </div>
                </div>
              </div>
          </uib-tab>
          <uib-tab active="archiveTab">
            <uib-tab-heading>
              Archived
              <i class="fa fa-archive"></i>
            </uib-tab-heading>

              <div class="row">
                <div class="col-sm-9" style="margin-top:15px">
                  <div style="position: absolute;top:400px;left:35%;" ng-if="loadingDataForArc">
                    <img src="https://media1.tenor.com/images/db85ba00c6073b451a8f05156a66524e/tenor.gif?itemid=9856796" alt="">
                  </div>
                  <div ng-if="!isTableView" class="col-md-4" style="margin-bottom:10px; padding-left:10px;padding-right:10px;" ng-repeat="data in archivedData " ng-click="tableArchAction($index)">
                    <!-- {{data[0]}} -->
                    <div class="container-fluid card" style="padding-bottom:0px">
                      <div class="row container-fluid" style="border-bottom: 1px solid #dedede; height:150px; opacity:0.9;letter-spacing:0.6px;">
                        <div class="col-md-12">
                          <h5 style="font-weight:501">Agent Name : {{data[0].user_id | getName}}
                             <span ng-if="data[0].rating == 5" class="pull-right">
                               <i class="fa fa fa-smile-o fa-lg" style="color:#086b0a" aria-hidden="true"></i>
                               <i class="fa fa-star fa-lg" style="color:#086b0a" aria-hidden="true"></i>
                              </span>
                             <span ng-if="data[0].rating == 4" class="pull-right">
                                <i class="fa fa fa-smile-o fa-lg" style="color:#2fdd23" aria-hidden="true"></i>
                               <i class="fa fa-star fa-lg" style="color:#2fdd23" aria-hidden="true"></i>
                              </span>
                             <span ng-if="data[0].rating == 3" class="pull-right">
                                <i class="fa fa-meh-o fa-lg" style="color:#dff20c" aria-hidden="true"></i>
                                <i class="fa fa-star fa-lg" style="color:#dff20c" aria-hidden="true"></i>
                               </span>
                             <span ng-if="data[0].rating == 2||data[0].rating == 1" class="pull-right">
                                <i class="fa fa fa-frown-o fa-lg" style="color:#f70202" aria-hidden="true"></i>
                                <i class="fa fa-star fa-lg" style="color:#f70202" aria-hidden="true"></i>
                            </span>
                          </h5>
                          <h5 style="font-weight:501">UID : {{data[0].uid}}
                            <span class="pull-right" style="color:#286090 ;font-size:15px">{{data[0].numOfComments}} <i class="fa fa-comments-o fa-lg" aria-hidden="true"></i></span>
                          </h5>
                          <h5 style="font-weight:501">Client : {{data[0].company}}</h5>
                          <h5 style="font-weight:501" ng-if="data[0].email">Visitor's Email :  {{data[0].email}}</h5>
                          <h5 style="font-weight:501" ng-if="data[0].chatDuration!=0">Chat Duration :  {{data[0].chatDuration}} Min</h5>
                          <h5 style="font-weight:501" ng-if="data[0].statusChat">Status :  {{data[0].statusChat}}
                             <span ng-if="data[0].statusChat!='started'">by {{data[0][data[0].statusChat+'By']}} on {{data[0][data[0].statusChat+'On'].split('.')[0]}} </span>
                           </h5>
                          <!-- <i class="fa fa-star" style="color:#fbd73f" aria-hidden="true"></i> -->
                        </div>
                      </div>
                      <div class="row container-fluid" style="padding-top:10px;height:50px;background-color:#286090; opacity:1">
                        <div class="col-md-12" style="color:#fff">
                          <h5>Date: {{data[0].created | date : 'dd-MMM-yyyy'}}
                            <span class="pull-right" style="cursor:pointer;"><i class="fa fa-info-circle fa-lg"></i></span>
                          </h5>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12" ng-if="isTableView">
                    <table style="width:100%;font-size:16px" id="myQATable" datatable="" class="row-border hover">
                      <thead>
                        <tr id="myQATableHeader">
                          <th style="text-align:center;display:none">Chat Start</th>
                        </tr>
                      </thead>
                     <tbody>
                       <tr ng-repeat="data in archivedData" style="" ng-click="tableArchAction(data,true)">
                         <td>
                           <div class="" style="border-radius:50%;width:50px;height:50px;margin:5px 10px;float:left">
                             <!-- <img style="width:50px" src="{{data[0].user_id| getDP}}" alt=""> -->
                             <img style="width:50px" src="http://icons.iconarchive.com/icons/hopstarter/sleek-xp-basic/256/Administrator-icon.png" alt="">
                           </div>
                           <span style="display:inline-block">
                             <div class="">
                               <span style="font-size: 15px;font-weight: 700;">{{data[0].user_id | getName}}</span>
                               <span style="font-size: 13px;font-weight: 400;">{{data[0].company? data[0].company:'-'}}</span>
                             </div>
                             <div class="">
                               <span style="font-size: 14px;">{{data[0].uid}}</span>
                             </div>
                             <div class="">
                               <span style="font-size: 13px;opacity: 0.8;">Created : {{data[0].created|  date : 'dd-MMM-yyyy'}}</span>
                             </div>
                           </span>
                           <div class="" style="margin:5px 10px;float:right;font-size:20px;padding:12px;opacity:0.6;">
                            <i ng-if="data[0].typ=='audio'" class="fa fa-phone fa-lg" aria-hidden="true"></i>
                            <i ng-if="data[0].typ=='video'" class="fa fa-video-camera fa-lg" aria-hidden="true"></i>
                          </div>
                         </td>
                       </tr>
                     </tbody>
                    </table>
                  </div>
                  <div class="" style="position: absolute;top:400px;left:40%;color:#f0f0f0;font-size:40px" ng-if="myDialouge">
                    No More Data
                  </div>
                </div>
                <div class="col-sm-3">
                  <div class="container-fluid" style="position:fixed;background-color:#f0f0f0;width:20%;padding:20px 30px;box-shadow:-1px -1px 1px #f6f6f6;height:100vh">
                      <div style="display:block;margin:10px 0px;">
                        <button type="button" class="btn btn-block btn-primary" ng-click="setMyView()" style="outline:none">
                           <i ng-if="!isTableView"class="fa fa-table fa-md"  aria-hidden="true">
                             <span>Switch to Table View</span>
                           </i>
                           <i ng-if="isTableView" class="fa fa-address-card-o fa-md" aria-hidden="true">
                             <span>Switch to Column View</span>
                           </i>
                        </button>
                      </div>
                      <div class="form-group">
                        <label> Select Date </label>
                        <div class="input-group">
                          <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="form.date" is-open="status.opened" />
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="status.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
                          </span>
                        </div>
                      </div>
                      <div class="form-group">
                        <label> Agent Name </label>
                        <input type="text" class="form-control" placeholder="Search and select" uib-typeahead="user as user.username for user in userSearch($viewValue)" ng-model="form.user">
                      </div>
                      <div class="form-group">
                        <label> Client Name </label>
                        <input type="text" class="form-control" placeholder="Search and select" uib-typeahead="service as service.name for service in serviceSearch($viewValue)" ng-model="form.client">
                      </div>
                      <div class="form-group">
                        <label> Visitor Email </label>
                        <input type="email" class="form-control" placeholder="User E-mail..." ng-model="form.email">
                      </div>
                      <div class="form-group">
                        <label>Select Chat Type (Audio/Video):</label>
                        <select class="form-control" ng-model="form.selectedChatType" style="outline:none">
                          <option ng-repeat="chatType in chatTypes" value="{{chatType}}">{{chatType}}</option>
                        </select>
                      </div>
                      <div class="btn-group" style="padding-top:20px;">
                        <button type="button" class="btn btn-primary" ng-click="filterData()">
                          <strong>Filter</strong>
                        </button>
                        <button type="button" class="btn btn-default" ng-click="download()" ng-if="reviewData.length>0">
                          Download <i class="fa fa-download"></i>
                        </button>

                      </div>
                      <div class="form-group" style="margin-top:20px">
                        <label>Sort By:</label>
                        <select class="form-control" ng-model="selectedSortOption" style="border:0">
                          <option ng-repeat="sort in sortOptions" value="{{sort}}" style="border:0">{{sort}} </option>
                        </select>
                      </div>
                  </div>
                </div>
              </div>

          </uib-tab>
          <uib-tab ng-repeat="tab in tabs" active="tab.active" disable="tab.disabled">
            <uib-tab-heading>
              {{tab.title}}
              <i ng-if="tab.cancel" class="fa fa-close" ng-click="closeTab($index);"></i>
            </uib-tab-heading>
            <div ng-if="tab.app == 'companyEdit'">
              <div ng-include="'/static/ngTemplates/app.customers.form.html'"></div>
            </div>
            <div ng-if="tab.app == 'AgentInfo'">
              <div ng-include="'/static/ngTemplates/app.sessionHistory.explore.html'"></div>
            </div>
          </uib-tab>

        </uib-tabset>
      </div>
  </div>
</div>
