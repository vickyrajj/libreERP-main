<div class="shaddowed card bg-white ">
  <div class="container-fluid" style="padding:15px;" ng-if="viewTyp=='edit'">

    <div class="row" ng-if="!posShowAll" style="font-size:20px">
      <div class="col-md-4">
        <label>Invoice Serial Number</label> - {{form.serialNumber}}
      </div>
      <!-- <div class="col-md-3">
        <div class="input-group">
          <input type="text" ng-model="form.cMobileNumber" class="form-control" placeholder="Enter Customer Mobile Number">
          <span class="input-group-btn">
            <button type="button" class="btn btn-success" ng-click="customerSeacrh()">Search</button>
          </span>
        </div>
        <p class="help-block" style="color:green;font-size:15px" ng-if="form.customer.pk">Our Customer ....</p>

      </div> -->
      <div class="col-md-8">
        <div class="col-md-7">
          <span ng-if="multiStore" style="font-size:21px">
            <div class="col-md-3 text-right">
              <label>Store :</label>
            </div>
            <div class="col-md-9">
              <input uib-typeahead="store as store.name for store in storeSearch($viewValue)" ng-model="storeForm.name" type="text" class="form-control" placeholder="Search By Store Name">
            </div>
          </span>
        </div>
        <div class="col-md-5" ng-if="posPrinter">
          <div class="input-group pull-right" ng-if="!connected">
            <input type="text" class="form-control" placeholder="Please enter device ID" ng-model="connectData.deviceID">
            <!-- <p class="help-block" style="font-size:12px">Please Connect The Device First</p> -->
            <span class="input-group-btn">
              <button type="button" class="btn btn-success" ng-click="connectDevice()">Connect</button>
            </span>
          </div>
          <div class="input-group pull-right" ng-if="connected">
            <input type="text" class="form-control" value="{{connectData.deviceID}}" disabled>
            <span class="input-group-btn">
              <button type="button" class="btn btn-danger" mwl-confirm title="Approve" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="disconnectDevice()" confirm-button-type="default" cancel-button-type="default">Disconnect</button>
            </span>
          </div>
        </div>

      </div>


    </div>
    <div class="row text-center" ng-if="!posShowAll && form.customer.pk" style="font-size:25px">
      <hr>
      <div class="col-md-12">
        <strong>Name : </strong>{{form.customer.name}} &nbsp; <strong>Address : </strong>{{form.customer.street}} , {{form.customer.city}} , {{form.customer.pincode}} , {{form.customer.state}} , {{form.customer.country}}
      </div>
    </div>
    <div class="row" ng-if="posShowAll">
      <div class="col-md-12" style="padding-bottom:25px" ng-if="posPrinter">
        <div class="col-md-4 col-md-offset-4">
          <div class="input-group" ng-if="!connected">
            <input type="text" class="form-control" placeholder="Please enter device ID" ng-model="connectData.deviceID">
            <span class="input-group-btn">
              <button type="button" class="btn btn-success" ng-click="connectDevice()">Connect</button>
            </span>
          </div>
          <div class="input-group" ng-if="connected">
            <input type="text" class="form-control" value="{{connectData.deviceID}}" disabled>
            <span class="input-group-btn">
              <button type="button" class="btn btn-danger" mwl-confirm title="Approve" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="disconnectDevice()" confirm-button-type="default" cancel-button-type="default">Disconnect</button>
            </span>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label>Invoice Serial Number</label>
              <input type="text" class="form-control" placeholder="Invoice Serial Number" ng-model="form.serialNumber" disabled>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label>Invoice Date</label>
              <div class="input-group">
                <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="form.invoicedate" is-open="statusInvDate.opened" disabled />
                <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="statusInvDate.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
              </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="{{multiStore ? 'col-md-6':'col-md-8'}}">
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label>Reference</label>
              <input type="text" class="form-control" placeholder="PO. Number,text" ng-model="form.reference">
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label>Due date</label>
              <div class="input-group">
                <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="form.duedate" is-open="statusDue.opened" ng-init="today" disabled/>
                <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="statusDue.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
              </span>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label>Return Quater</label>
              <select ng-model="form.returnquater" class="form-control">
                <option value="" disabled selected>select Return Quater</option>
                <option value="jan-march">January - March</option>
                <option value="april-june">April - June</option>
                <option value="july-sep">July - September</option>
                <option value="oct-dec">October - December</option>
              </select>
              </input>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label> Mode of Payment</label>
              <select class="form-control" ng-model="form.modeOfPayment">
                <option value="" disabled selected>select mode of payment</option>
                <option value="cash">Cash</option>
                <option value="netBanking">Net Banking</option>
                <option value="card">Card</option>
                <option value="cheque">Cheque</option>
                <option value="cashOnDelivery">Cash On Delivery</option>
              </select>
            </div>
          </div>


        </div>
      </div>
      <div class="col-md-2" ng-if="multiStore">
        <div class="form-group">
          <label>Store :</label>
          <input uib-typeahead="store as store.name for store in storeSearch($viewValue)" ng-model="storeForm.name" type="text" class="form-control" placeholder="Search By Store Name">
        </div>
      </div>
    </div>
    <hr>
    <div class="row" ng-if="posShowAll">
      <div class="col-md-5">
        <div class="col-md-10" style="padding-left: 0px;">
          <div class="form-group">
            <label>Customer Name</label>
            <div class="{{(showCreateCustomerBtn || customerExist) && !showCustomerForm ? 'input-group':''}}">
              <input uib-typeahead="customer as customer.name for customer in customerNameSearch($viewValue)" ng-model="form.customer" type="text" class="form-control" placeholder="Search using customer name">
              <span ng-click="openCustomerForm()" ng-if="(showCreateCustomerBtn || customerExist) && !showCustomerForm" class="input-group-addon btn btn-primary"><i class="fa fa-{{!customerExist ? 'plus':'pencil'}}"></i> {{ !customerExist?  'New':'Edit'}}</span>
            </div>
          </div>
          <div class="row" ng-if="form.customer.pk">
            <div class="col-md-6">
              <div class="form-group">
                <label>GSTIN:</label>
                <span>{{form.customer.gst}}</span>
              </div>
              <div class="form-group">
                <label>PAN NO.:</label>
                <span>{{form.customer.pan}}</span>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label>Place of Supply:</label>
                <!-- <input type="text" class="form-control"  ng-model="form.customer.city" disabled> -->
                <span>{{form.customer.city}}</span>
                <!-- <select class="form-control">
                    <option>{{form.customer.state}}</option>

                  </select> -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-5" ng-if="form.customer.pk">
        <div class="row">
          <div class="col-md-6" style="margin-top: 43px;">
            <span><b>Billing Address</b></span><br>
            <span>{{form.customer.streetBilling}}</span><br>
            <span>{{form.customer.cityBilling}}</span><br>
            <span>{{form.customer.stateBilling}}</span>
            <span>{{form.customer.pincodeBilling}}</span><br>
            <span>{{form.customer.countryBilling}}</span>
          </div>
          <div class="checkbox">
            <label><input type="checkbox" value="checked" style="margin-top: -2px;"ng-model="form.customer.sameAsShipping">&nbsp; Billing Address Same as Shipping</label>
          </div>
          <div class="col-md-6" ng-if="!form.customer.sameAsShipping">
            <span><b>Shipping Address</b></span><br>
            <span>{{form.customer.street}}</span><br>
            <span>{{form.customer.city}}</span><br>
            <span>{{form.customer.state}}</span>
            <span>{{form.customer.pincode}}</span><br>
            <span>{{form.customer.country}}</span>
          </div>

        </div>
      </div>

      <div class="col-md-2 pull-right">
        <div class="form-group">
          <label>Amount Recieved</label>
          <input type="number" class="form-control" ng-model="form.amountRecieved">
        </div>
        <div class="form-group">
          <label>Payment Ref. Number</label>
          <input type="text" class="form-control" ng-model="form.paymentRefNum">
        </div>
        <div class="form-group">
          <label>Received Date</label>
          <div class="input-group">
            <input type="text" class="form-control" show-weeks="false" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="form.receivedDate" is-open="statusPayment.opened" ng-init="today" disabled/>
            <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="statusPayment.opened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
          </span>
          </div>
        </div>

      </div>

    </div>

    <div class="container-fluid" style="padding:0px">
      <table class="invoiceTable" style=" width: 100%;border-collapse: collapse;font-size:{{posShowAll?'17px':'25px'}}">
        <tr style="background-color: #eeeeee;height: 96px;">
          <th>#</th>
          <th style="font-size:{{posShowAll?'17px':'25px'}}">Item Description</th>
          <th ng-if="posShowAll">Item Type</th>
          <th ng-if="posShowAll">HSN/SAC</th>
          <th>Qty</th>
          <th>Rate(Rs.)</th>
          <th ng-if="posShowAll">Tax</th>
          <th>Subtotal</th>
          <th></th>
        </tr>
        <tr ng-repeat="item in form.products">
          <td>{{$index + 1}}</td>
          <td>
            <input type="text" class="form-control-pos" ng-model="item.data" uib-typeahead="p as p.name for p in productSearch($viewValue)" style="font-size:{{posShowAll?'17px':'25px'}}">
          </td>
          <td ng-if="posShowAll">
            <span ng-if="item.data.pk">{{item.data.product.productMeta.typ == 'SAC'? 'Service' : 'Product'}}</span>
          </td>
          <td ng-if="posShowAll">
            <span ng-if="item.data.pk">{{item.data.product.productMeta.code}} ( {{item.data.product.productMeta.taxRate}} %)</span>
          </td>
          <td>
            <input type="number" class="form-control-pos" ng-model="item.quantity" ng-if="item.data.pk" style="font-size:{{posShowAll?'17px':'25px'}};text-align: center;height:40px" min="1">
          </td>
          <td>
            <input type="float" class="form-control-pos" value="{{item.data.productVariant!=null?item.data.productVariant.price:item.data.product.price}}" ng-if="item.data.pk&&posShowAll" style="font-size:17px;text-align: center;">
            <input type="float" class="form-control-pos" value="{{item.data.productVariant!=null?item.data.productVariant.price:item.data.product.price}}" ng-if="item.data.pk&&!posShowAll" style="font-size:25px;text-align: center;">
          </td>
          <td ng-if="posShowAll">
            <span ng-if="item.data.pk&&item.data.productVariant!=null"> {{item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.productVariant.price / 100)).toFixed(2) : 0}}</span>
            <span ng-if="item.data.pk&&item.data.productVariant==null"> {{item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.product.price / 100)).toFixed(2) : 0}}</span>
          </td>
          <td>
            <span ng-if="item.data.pk&&item.data.productVariant!=null">{{ ((item.quantity * item.data.productVariant.price) +  (item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.productVariant.price / 100)) : 0)) }}</span>
            <span ng-if="item.data.pk&&item.data.productVariant==null">{{ ((item.quantity * item.data.product.price) +  (item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.product.price / 100)) : 0)).toFixed(2) }}</span>
          </td>
          <td>
            <button type="button" class="btn btn-danger btn-sm" ng-click="delete($index)" style="font-size:{{posShowAll?'17px':'25px'}}"> <i class="fa fa-trash"></i> </button>
          </td>
        </tr>
        <tr>
          <td>
            <div class="container-fluid" style="padding:0px;">
              <button style="background-color:white;border:none;" ng-click="addRow()"><i class="fa fa-plus" aria-hidden="true"  style="cursor:pointer"></i>
                </button>
            </div>
          </td>
          <td style="border:none;"></td>
          <td style="border:none;" ng-if="posShowAll"></td>
          <td style="border:none;" ng-if="posShowAll"></td>
          <td style="border:none;"></td>
          <td style="border:none;"></td>
          <td ng-if="form.products[0].data.pk&&posShowAll">{{subTotalTax()}}</td>
          <td ng-if="form.products[0].data.pk&&posShowAll" style="font-size:17px">{{subTotal()}}</td>
          <td ng-if="form.products[0].data.pk&&!posShowAll" style="font-size:30px;background-color:black;color:white"><b>{{subTotal()}}</b></td>

        </tr>
      </table>

    </div>

    <div class="down-part">
      <div class="col-md-12 text-center">
        <div class="btn-group">
          <button type="button" class="btn btn-success" ng-click="saveInvoice()" style="font-size:20px" ng-if="posShowAll">Save</button>
          <button type="button" class="btn btn-success" ng-click="saveInvoice('Small Form')" style="font-size:20px" ng-if="!posShowAll">Save</button>
          <button type="button" class="btn btn-primary" style="font-size:20px" mwl-confirm title="Confirm Order" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="orderConfirm($index)" confirm-button-type="default"
            cancel-button-type="default">Confirm</button>
        </div>
      </div>
    </div>

  </div>

  <div class="container-fluid" style="padding:15px;" ng-if="viewTyp=='view'">
    <div class="col-md-12 text-center">
      <h2>Order Details ({{form.created | timeAgo}})</h2>
    </div>
    <div class="col-md-12 text-center" ng-if="form.customer" style="font-size:18px">
      <strong>Name : </strong>{{form.customer.name}} &nbsp; <strong>Mobile : </strong>{{form.customer.mobile}} &nbsp; <strong>Address : </strong>{{form.customer.street}} , {{form.customer.city}} , {{form.customer.pincode}} , {{form.customer.state}} ,
      {{form.customer.country}}
    </div>
    <div class="container-fluid" style="padding:0px">
      <table class="invoiceTable" style=" width: 100%;border-collapse: collapse;font-size:20px">
        <tr style="background-color: #eeeeee;height: 96px;">
          <th>#</th>
          <th style="font-size:20px">Item Description</th>
          <th>Qty</th>
          <th>Rate(Rs.)</th>
          <th>Subtotal</th>
        </tr>
        <tr ng-repeat="item in form.products">
          <td>{{$index + 1}}</td>
          <td>
            <span style="font-size:20px">{{item.data.name}}</span>
            <!-- <input type="text" class="form-control-pos"  ng-model="item.data" uib-typeahead="p as p.name for p in productSearch($viewValue)" style="font-size:{{posShowAll?'17px':'25px'}}"> -->
          </td>
          <td>
            <span style="font-size:20px" ng-if="item.data.pk">{{item.quantity}}</span>

          </td>
          <td>
            <span style="font-size:20px;" ng-if="item.data.pk&&!posShowAll">{{item.data.productVariant!=null?item.data.productVariant.price:item.data.product.price}}</span>

          </td>
          <td>
            <span ng-if="item.data.pk&&item.data.productVariant!=null">{{ ((item.quantity * item.data.productVariant.price) +  (item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.productVariant.price / 100)) : 0)) }}</span>
            <span ng-if="item.data.pk&&item.data.productVariant==null">{{ ((item.quantity * item.data.product.price) +  (item.data.product.productMeta ? (item.quantity * (item.data.product.productMeta.taxRate * item.data.product.price / 100)) : 0)).toFixed(2) }}</span>
          </td>
        </tr>
        <tr>
          <td style="border:none;"></td>
          <td style="border:none;"></td>
          <td style="border:none;"></td>
          <td style="border:none;"></td>
          <td ng-if="form.products[0].data.pk&&!posShowAll" style="font-size:30px;background-color:black;color:white"><b>{{subTotal()}}</b></td>
        </tr>
      </table>

    </div>
  </div>
</div>
